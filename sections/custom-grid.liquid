{% schema %}
{
  "name": "Product Grid with Popup",
  "settings": [
    { "type": "product", "id": "product_1", "label": "Product 1" },
    { "type": "product", "id": "product_2", "label": "Product 2" },
    { "type": "product", "id": "product_3", "label": "Product 3" },
    { "type": "product", "id": "product_4", "label": "Product 4" },
    { "type": "product", "id": "product_5", "label": "Product 5" },
    { "type": "product", "id": "product_6", "label": "Product 6" }
  ],
  "presets": [ { "name": "Product Grid" } ]
}
{% endschema %}

<style>
/* Grid styles */
.product-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  margin: 40px 0;
}
.product-block {
  text-align: center;
  border: 1px solid #e0e0e0;
  padding: 20px;
  cursor: pointer;
  transition: transform 0.3s ease;
}
.product-block:hover { transform: translateY(-5px); }
.product-block img { max-width: 100%; height: auto; margin-bottom: 10px; }

.popup {
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.6);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}
.popup-content {
  background: #fff;
  padding: 30px;
  max-width: 600px;
  width: 90%;
  position: relative;
}
.popup-close {
  position: absolute; top: 10px; right: 15px;
  font-size: 20px;
  cursor: pointer;
}
</style>

<div class="product-grid">
  {% for i in (1..6) %}
    {% assign product_key = 'product_' | append: i %}
    {% assign product_handle = section.settings[product_key] %}
    {% if product_handle %}
      {% assign product = all_products[product_handle] %}
      {% if product %}
        <div class="product-block">
          <img src="{{ product.featured_image | img_url: 'medium' }}" alt="{{ product.title }}">
          <div class="product-info">
            <h3>{{ product.title }}</h3>
            <p>{{ product.price | money }}</p>
            <a href="{{ product.url }}" class="btn">View Product</a>
          </div>
        </div>
      {% endif %}
    {% endif %}
  {% endfor %}
</div>

<div class="popup">
  <div class="popup-content"></div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const blocks = document.querySelectorAll('.product-block');
  const popup = document.querySelector('.popup');
  const popupContent = document.querySelector('.popup-content');

  blocks.forEach(block => {
    block.addEventListener('click', () => {
      popupContent.innerHTML = '<span class="popup-close">&times;</span>' + block.querySelector('.product-info').innerHTML;
      popup.style.display = 'flex';

      popupContent.querySelector('.popup-close').addEventListener('click', () => {
        popup.style.display = 'none';
      });
    });
  });

  popup.addEventListener('click', (e) => {
    if (e.target === popup) popup.style.display = 'none';
  });
});
</script>
